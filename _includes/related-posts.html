<div class="related">
  <p><b>{{ site.data.settings.related_posts }}</b></p>
  {% assign listed_posts_urls = page.url | split: ' ' %}
  <ul class="related-posts">
    {% for tag in page.tags %}
      {% for mypost in site.tags[tag] %}
        {% if listed_posts_urls contains mypost.url %}
        {% else %}
          <li>
            <p>
              <a href="{{ site.github.url }}{{ mypost.url }}">
                {{ mypost.title }}
              </a>
            </p>
          </li>
          {% assign listed_posts_urls = listed_posts_urls | push: mypost.url %}
        {% endif %}
      {% endfor %}
    {% endfor %}

    {% for category in page.categories %}
      {% for mypost in site.categories[category] %}
        {% if listed_posts_urls contains mypost.url %}
        {% else %}
          <li>
            <p>
              <a href="{{ site.github.url }}{{ mypost.url }}">
                {{ mypost.title }}
              </a>
            </p>
          </li>
          {% assign listed_posts_urls = listed_posts_urls | push: mypost.url %}
        {% endif %}
      {% endfor %}
    {% endfor %}
  </ul>
</div>
